(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     34522,        745]
NotebookOptionsPosition[     33835,        728]
NotebookOutlinePosition[     34178,        743]
CellTagsIndexPosition[     34135,        740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global'*\>\"", "]"}], "\n", 
 RowBox[{
  RowBox[{"$PrePrint", "=", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MatrixQ", "[", "#", "]"}], ",", 
      RowBox[{"MatrixForm", "[", "#", "]"}], ",", "#"}], "]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", " ", "=", " ", "2"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Number", " ", "of", " ", "qubits", " ", "being", " ", "teleported"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sub", "[", 
   RowBox[{"i_", ",", "j_", ",", "b_"}], "]"}], " ", ":=", 
  RowBox[{"HoldForm", "[", 
   RowBox[{"Subscript", "[", 
    RowBox[{"b", ",", "i"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"genmat", "[", 
   RowBox[{"m_", ",", "n_", ",", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"sub", "[", 
     RowBox[{"i", ",", "j", ",", "b"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "m"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aliceKet", " ", "=", " ", 
    RowBox[{"genmat", "[", 
     RowBox[{
      RowBox[{"2", "^", "n"}], ",", "1", ",", " ", "\[Alpha]"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Alice", " ", "unknown", " ", "state", " ", "to", " ", "teleport", " ", 
    "on", " ", "8", " ", "qubits"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "creating", " ", "our", " ", "8", " ", "Bell", " ", "pairs", 
    " ", "to", " ", "start"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiPlustmp", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"phiPlus", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "n"}], ",", 
    RowBox[{"i", "++"}], ",", " ", 
    RowBox[{"phiPlus", " ", "=", " ", 
     RowBox[{"ArrayFlatten", "[", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"phiPlus", ",", "phiPlustmp"}], "]"}], "]"}]}]}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"All", " ", "Bell", " ", "pairs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Now", " ", "defining", " ", "our", " ", "CNOT", " ", "and", " ", 
    "Hadamard", " ", "gates"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cNot", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cNottmp", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hadamard", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hadamardtmp", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], ")"}], "*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigmaX", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.820803709159586*^9, 3.82080372151005*^9}, {
   3.820803831023531*^9, 3.8208041208145037`*^9}, {3.820804157861252*^9, 
   3.820804165149417*^9}, {3.8208042149356346`*^9, 3.8208042269457912`*^9}, {
   3.8208042669952374`*^9, 3.8208044686550436`*^9}, {3.8208045574920406`*^9, 
   3.8208047762180405`*^9}, {3.8208050507031727`*^9, 3.820805157736122*^9}, {
   3.820805264420469*^9, 3.82080527265548*^9}, {3.8208053321552935`*^9, 
   3.82080538975432*^9}, {3.820805575865218*^9, 3.8208055775242853`*^9}, {
   3.8208062352449846`*^9, 3.820806262822777*^9}, {3.820806324522685*^9, 
   3.820806329034628*^9}, {3.820806391822753*^9, 3.8208063960127907`*^9}, {
   3.8208064277938104`*^9, 3.8208064279719715`*^9}, {3.8208064746834183`*^9, 
   3.8208064919147997`*^9}, {3.8208065482435193`*^9, 3.82080654862358*^9}, {
   3.820807810704374*^9, 3.8208078107930593`*^9}, {3.820807851176784*^9, 
   3.820807851263092*^9}, {3.820807946084766*^9, 3.820807961782992*^9}, {
   3.820808046005368*^9, 3.820808052224104*^9}, {3.8208080962156553`*^9, 
   3.8208080963748055`*^9}, {3.820809053725271*^9, 3.8208090648634124`*^9}, {
   3.820809270997982*^9, 3.820809272294637*^9}, {3.8208102181310673`*^9, 
   3.820810254009825*^9}, {3.820810414265793*^9, 3.820810422815508*^9}, {
   3.820810470635956*^9, 3.820810485124885*^9}, {3.8208106346887894`*^9, 
   3.820810662255642*^9}, {3.82081085001317*^9, 3.820810878542367*^9}, {
   3.8208110312474585`*^9, 3.820811082375851*^9}, {3.8208113291938267`*^9, 
   3.8208113359369407`*^9}, {3.820811438857252*^9, 3.8208114389764853`*^9}, {
   3.821333203038002*^9, 3.821333203193323*^9}, {3.821334691015232*^9, 
   3.8213346917632427`*^9}, {3.8214058558302183`*^9, 3.821405856024262*^9}, {
   3.8214060411457367`*^9, 3.8214060414237356`*^9}, {3.8214061470051174`*^9, 
   3.821406147184095*^9}, {3.8214064999618597`*^9, 3.8214065001108847`*^9}, {
   3.8214066029367657`*^9, 3.821406603116746*^9}, {3.821407678305133*^9, 
   3.8214076786041164`*^9}, {3.8214082279454346`*^9, 
   3.8214082280828295`*^9}, {3.8214082648631487`*^9, 
   3.8214082649917192`*^9}, {3.8214083628056335`*^9, 3.82140836293483*^9}, {
   3.821409465278948*^9, 3.8214094653886633`*^9}, {3.821410990408592*^9, 
   3.8214109905901318`*^9}, {3.821411600679169*^9, 3.8214116032710695`*^9}, {
   3.821412233306203*^9, 3.821412233461443*^9}, {3.8214122968291483`*^9, 
   3.821412296963113*^9}, {3.8214136083346515`*^9, 3.821413608519945*^9}, {
   3.8214143007445354`*^9, 3.821414300849216*^9}, {3.8214143963633785`*^9, 
   3.8214143965605593`*^9}, {3.821415118981372*^9, 3.821415119138404*^9}, {
   3.821415233632569*^9, 3.8214152338214993`*^9}, {3.821418198256618*^9, 
   3.8214181988826995`*^9}, {3.8214191845822735`*^9, 3.821419184832274*^9}, {
   3.8214194086247807`*^9, 3.8214194273606825`*^9}, {3.8214206022578754`*^9, 
   3.8214206023739147`*^9}, {3.8215045178717737`*^9, 3.821504517997898*^9}, {
   3.8215047797633133`*^9, 3.821504780024394*^9}, {3.821504973427067*^9, 
   3.821504973552174*^9}, {3.8215050085256157`*^9, 3.8215050086765003`*^9}, {
   3.8215050476561418`*^9, 3.8215050477812347`*^9}, {3.8215055585203605`*^9, 
   3.821505558629756*^9}, {3.821505618921692*^9, 3.8215056190793076`*^9}, {
   3.8215056729551663`*^9, 3.8215056731271396`*^9}, {3.821505923954342*^9, 
   3.8215059240791793`*^9}, {3.821506182855643*^9, 3.8215061830336127`*^9}, {
   3.821506576347226*^9, 3.8215065765660195`*^9}, {3.821506710129921*^9, 
   3.8215067119449277`*^9}, {3.8215075770476074`*^9, 
   3.8215075771726017`*^9}, {3.8215082613807793`*^9, 
   3.8215082623190727`*^9}, {3.8217639241507287`*^9, 3.82176392889419*^9}, {
   3.821765071794733*^9, 3.821765083535946*^9}, {3.821769798895708*^9, 
   3.8217699130920286`*^9}, 3.8217701940408063`*^9, {3.8217706905583735`*^9, 
   3.8217707980220566`*^9}, {3.821772469533695*^9, 3.8217724887974806`*^9}, 
   3.8217727689921265`*^9, {3.8224625551501527`*^9, 3.8224626072370396`*^9}, {
   3.8224627024103365`*^9, 3.822462703058486*^9}, {3.8224628428749294`*^9, 
   3.822462860558552*^9}, {3.8224629262883883`*^9, 3.822462938866867*^9}, {
   3.82246299997556*^9, 3.8224630829665174`*^9}, {3.8224631176458607`*^9, 
   3.8224631441722*^9}, {3.822463181121483*^9, 3.8224632017942743`*^9}, {
   3.82246340775729*^9, 3.82246340790514*^9}, {3.8224640977712755`*^9, 
   3.8224641043663645`*^9}, {3.8224642992802415`*^9, 3.822464302445037*^9}, {
   3.822464584649502*^9, 3.8224645872543573`*^9}, {3.822464771972561*^9, 
   3.8224647793269453`*^9}, {3.8224648780568295`*^9, 
   3.8224648839051514`*^9}, {3.828234293716876*^9, 
   3.828234300893752*^9}},ExpressionUUID->"a5071188-9e4c-40ea-ab6d-\
b5ca7fd81fd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Constructing", " ", "the", " ", "full", " ", "24", " ", "qubit", " ", 
    "state"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "n"}], ",", 
     RowBox[{"i", "++"}], ",", " ", 
     RowBox[{"cNot", " ", "=", " ", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"TensorProduct", "[", 
        RowBox[{"cNot", ",", "cNottmp"}], "]"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "n"}], ",", 
     RowBox[{"i", "++"}], ",", " ", 
     RowBox[{"hadamard", " ", "=", " ", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"TensorProduct", "[", 
        RowBox[{"hadamard", ",", "hadamardtmp"}], "]"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psiInitial", " ", "=", " ", 
     RowBox[{"(", 
      RowBox[{"ArrayFlatten", "[", 
       RowBox[{"TensorProduct", "[", 
        RowBox[{"aliceKet", ",", "phiPlus"}], "]"}], "]"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"psi24", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ArrayFlatten", "[", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"hadamard", ",", 
          RowBox[{"IdentityMatrix", "[", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"2", "*", "n"}], ")"}]}], "]"}]}], "]"}], "]"}], ")"}], 
      ".", "cNot", ".", "psiInitial"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.820805581347709*^9, 3.8208057440541315`*^9}, {
   3.820805924428144*^9, 3.820805996157276*^9}, {3.8208063412921124`*^9, 
   3.8208063635532207`*^9}, {3.8208064130928783`*^9, 3.820806420812165*^9}, {
   3.820806508698489*^9, 3.820806512545016*^9}, {3.820806551186751*^9, 
   3.820806571072914*^9}, {3.820806672520048*^9, 3.8208066815801525`*^9}, {
   3.8208073508877907`*^9, 3.8208073613566637`*^9}, {3.820807454733474*^9, 
   3.82080754233171*^9}, {3.820807580053773*^9, 3.820807701463538*^9}, {
   3.8208077734294457`*^9, 3.820807786733698*^9}, {3.820807819824881*^9, 
   3.8208078386327963`*^9}, {3.82080791703362*^9, 3.820807938103982*^9}, {
   3.82080804031804*^9, 3.820808040784975*^9}, {3.820808084005022*^9, 
   3.820808109435283*^9}, {3.820808243294798*^9, 3.820808244285388*^9}, {
   3.8208092923082075`*^9, 3.820809301294973*^9}, {3.821413959004215*^9, 
   3.821413961826745*^9}, 3.821415084375942*^9, {3.8217582173815317`*^9, 
   3.8217582344786105`*^9}, {3.8217590202455673`*^9, 
   3.8217590214750524`*^9}, {3.8217644139815884`*^9, 3.821764415483426*^9}, 
   3.8217694272321205`*^9, {3.8217694591939154`*^9, 3.821769459600294*^9}, {
   3.8217696795839586`*^9, 3.8217697120116916`*^9}, {3.8217697453379617`*^9, 
   3.8217697961314793`*^9}, {3.8217699218810344`*^9, 
   3.8217700494510255`*^9}, {3.8217706809634495`*^9, 
   3.8217706836011534`*^9}, {3.8217708266665072`*^9, 3.82177083014212*^9}, 
   3.8224625579970984`*^9, {3.8282343041242695`*^9, 
   3.8282343267027073`*^9}},ExpressionUUID->"1f95a0d4-ebdc-46de-ab20-\
11831e17cbe4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"(*", "          ", 
    RowBox[{"This", " ", "is", " ", "the", " ", "random", " ", "scheme"}], 
    "                         ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Alice", " ", "then", " ", "measures", " ", "the", " ", "first", " ", 
      "16", " ", "qubits", " ", "and", " ", "gets", " ", "a", " ", "random", 
      " ", "outcome", " ", "state", " ", 
      RowBox[{"e", ".", "g", "."}]}], " ", "|", 
     RowBox[{
      RowBox[{
       RowBox[{"110010110001", "..."}], ".1"}], ">"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aliceMeasure", " ", "=", " ", 
     RowBox[{"genmat", "[", 
      RowBox[{
       RowBox[{"2", "^", 
        RowBox[{"(", 
         RowBox[{"2", "*", "n"}], ")"}]}], ",", "1", ",", " ", "\[Beta]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "first", " ", "half", " ", "of", " ", "C", " ", "applies", 
      " ", "sigmaX", " ", "and", " ", "the", " ", "2", "nd", " ", "half", " ",
       "applies", " ", "sigma", " ", "Z", " ", "if", " ", "1"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"clist", " ", "=", " ", 
     RowBox[{"NumberExpand", "[", 
      RowBox[{"0", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{
         RowBox[{"Length", "[", "clist", "]"}], "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"clist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
         RowBox[{
          RowBox[{"clist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}], "]"}]}], "]"}], 
     RowBox[{"(*", " ", 
      RowBox[{
      "now", " ", "this", " ", "is", " ", "just", " ", "a", " ", "binary", 
       " ", "list"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "clist", "]"}], "<", 
        RowBox[{"(", 
         RowBox[{"2", "*", "n"}], ")"}]}], ",", 
       RowBox[{"clist", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"clist", ",", "0", ",", "1"}], "]"}]}]}], "]"}]}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"adding", " ", "leading", " ", "zeroes"}], " ", "*)"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", " ", 
    RowBox[{"Selective", " ", "state", " ", "scheme"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aliceMeasure", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"clist", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Remaining", " ", "state", " ", "in", " ", 
      RowBox[{"Bob", "'"}], "s", " ", "possession"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"bobRemaining", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ConjugateTranspose", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"aliceMeasure", ",", " ", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{"2", "^", "n"}], "]"}]}], "]"}], "]"}], "]"}], ")"}], ".",
       "psi24"}]}], " ", ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Note", " ", "only", " ", "half", " ", "of", " ", "the", " ", "states", 
       " ", "are", " ", "possible", " ", "to", " ", "be", " ", "measured", 
       " ", "here"}], ",", " ", 
      RowBox[{
      "for", " ", "the", " ", "other", " ", "half", " ", "must", " ", "use", 
       " ", "other", " ", "Bell", " ", "state"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Probability", " ", "of", " ", "Alice", " ", "measuring", " ", "a", " ", 
      "particular", " ", "state", " ", "P"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"measureProb", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "bobRemaining", "]"}], ".", 
        RowBox[{"Conjugate", "[", "bobRemaining", "]"}]}], ")"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.820808246096311*^9, 3.820808255513671*^9}, {
   3.820808306023877*^9, 3.820808348085312*^9}, {3.820808389316311*^9, 
   3.820808411948332*^9}, {3.82080844943709*^9, 3.8208086626484766`*^9}, {
   3.8208086994601173`*^9, 3.8208087342975636`*^9}, {3.820808879907114*^9, 
   3.8208089049137135`*^9}, {3.820808969935266*^9, 3.8208090430930758`*^9}, {
   3.820809123264349*^9, 3.82080914095483*^9}, {3.82080921055472*^9, 
   3.8208092449239655`*^9}, {3.8208093841097717`*^9, 3.82080940979803*^9}, {
   3.820809462569519*^9, 3.8208095082781935`*^9}, {3.820809538798629*^9, 
   3.8208097991772504`*^9}, {3.8208098307104225`*^9, 
   3.8208101177594624`*^9}, {3.8208101514788837`*^9, 
   3.8208101560789385`*^9}, {3.8208102046604567`*^9, 3.820810208382908*^9}, {
   3.820810246851082*^9, 3.8208102497601137`*^9}, {3.820810395437967*^9, 
   3.820810401563941*^9}, {3.8208104396672134`*^9, 3.8208105575150084`*^9}, {
   3.8208107055571146`*^9, 3.820810756875808*^9}, {3.820810833544379*^9, 
   3.82081084111223*^9}, {3.820811009766714*^9, 3.8208110220854235`*^9}, {
   3.82081107124944*^9, 3.8208110922275124`*^9}, {3.820811314946999*^9, 
   3.82081132042698*^9}, {3.820811356158003*^9, 3.820811413225787*^9}, {
   3.820811456421712*^9, 3.820811567646511*^9}, {3.8213304280629387`*^9, 
   3.821330471474933*^9}, {3.8213305212844977`*^9, 3.821330576186473*^9}, {
   3.8213306642061214`*^9, 3.82133073487047*^9}, {3.821330778989693*^9, 
   3.8213308804164085`*^9}, {3.821330925378001*^9, 3.821330942820999*^9}, {
   3.8213310649471045`*^9, 3.8213311096575713`*^9}, {3.8213312410328007`*^9, 
   3.8213312449198017`*^9}, {3.821331275687434*^9, 3.821331312108284*^9}, {
   3.8214057713942914`*^9, 3.8214057823770094`*^9}, {3.821405838938593*^9, 
   3.821405880033396*^9}, {3.8214188296273723`*^9, 3.8214188826934876`*^9}, {
   3.821419096243088*^9, 3.8214191199196587`*^9}, 3.821419153434844*^9, {
   3.821506028421359*^9, 3.8215061399337053`*^9}, {3.821506187302621*^9, 
   3.8215063275324016`*^9}, {3.8215065271631174`*^9, 3.821506535590124*^9}, {
   3.821506570444336*^9, 3.821506720236308*^9}, {3.821507547327846*^9, 
   3.8215075665088606`*^9}, {3.8215079078138466`*^9, 
   3.8215080268008823`*^9}, {3.8215081400561247`*^9, 
   3.8215081701189437`*^9}, {3.8215082508616085`*^9, 
   3.8215083141785374`*^9}, {3.8217588267262163`*^9, 
   3.8217588304636316`*^9}, {3.821759001122715*^9, 3.8217591434800816`*^9}, {
   3.821759222878075*^9, 3.821759239460597*^9}, {3.8217598874212313`*^9, 
   3.821759889851785*^9}, {3.8217619650278945`*^9, 3.8217619689310975`*^9}, {
   3.821762002834284*^9, 3.821762004204807*^9}, {3.8217620350640583`*^9, 
   3.8217621251107244`*^9}, {3.8217621832076902`*^9, 
   3.8217621913839827`*^9}, {3.8217651440975213`*^9, 3.8217651733377*^9}, {
   3.8217694328318853`*^9, 3.8217694357246857`*^9}},
 CellLabel->
  "In[325]:=",ExpressionUUID->"3efc7279-b01f-4419-b1d6-56c24dcf0a44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Reconstructing", " ", 
    RowBox[{"Alice", "'"}], "s", " ", "original", " ", "unknown", " ", 
    "state", " ", "using", " ", "Pauli", " ", "Gates"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sigmaX", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmaZ", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"iMatrix", "[", "n_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", 
        RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bobRemaining", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "^", "n"}], ")"}], "*", "bobRemaining"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aFlat", "[", "x_", "]"}], ":=", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayDepth", "[", "x", "]"}], "\[LessEqual]", "2"}], ",", 
         "x", ",", 
         RowBox[{"ArrayFlatten", "[", "x", "]"}]}], "]"}], 
       "\[IndentingNewLine]", "bobRemaining", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "now", " ", "we", " ", "apply", " ", "the", " ", "corrections", " ", 
         "using", " ", "the", " ", "pauli", " ", "gates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", "n"}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"clist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
           RowBox[{"bobRemaining", "=", 
            RowBox[{
             RowBox[{"aFlat", "[", 
              RowBox[{"aFlat", "[", 
               RowBox[{"TensorProduct", "[", 
                RowBox[{
                 RowBox[{"iMatrix", "[", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}]}], "]"}], ",", "sigmaZ", 
                 ",", 
                 RowBox[{"iMatrix", "[", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"n", "-", "i"}], ")"}]}], "]"}]}], "]"}], "]"}], 
              "]"}], ".", "bobRemaining"}]}]}], "]"}]}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", 
          RowBox[{"n", "+", "1"}]}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"(", 
           RowBox[{"2", "*", "n"}], ")"}]}], ",", 
         RowBox[{"i", "++"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"clist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "==", "1"}], ",", 
           RowBox[{"bobRemaining", "=", 
            RowBox[{
             RowBox[{"aFlat", "[", 
              RowBox[{"aFlat", "[", 
               RowBox[{"TensorProduct", "[", 
                RowBox[{
                 RowBox[{"iMatrix", "[", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{"i", "-", "n", "-", "1"}], ")"}]}], "]"}], ",", 
                 "sigmaX", ",", 
                 RowBox[{"iMatrix", "[", 
                  RowBox[{"2", "^", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "n"}], "-", "i"}], ")"}]}], "]"}]}], 
                "]"}], "]"}], "]"}], ".", "bobRemaining"}]}]}], "]"}]}], 
        "]"}], "\[IndentingNewLine]", "bobRemaining"}]}]}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.820811570127534*^9, 3.820811647635703*^9}, {
   3.8208118690723*^9, 3.82081198048166*^9}, {3.820813849237658*^9, 
   3.82081387971854*^9}, {3.8213314130775023`*^9, 3.821331483226553*^9}, {
   3.82133162319407*^9, 3.8213316894623547`*^9}, {3.8213319481629324`*^9, 
   3.821332032572651*^9}, {3.8213320770522795`*^9, 3.8213321138534584`*^9}, {
   3.8213321659156256`*^9, 3.8213322212520103`*^9}, {3.8213322876750455`*^9, 
   3.8213324047825017`*^9}, 3.8213325987594943`*^9, {3.821332663929247*^9, 
   3.8213326666378293`*^9}, {3.821332736481036*^9, 3.8213328538884563`*^9}, {
   3.8213329279147825`*^9, 3.821332953501939*^9}, {3.821333058396628*^9, 
   3.82133316886584*^9}, {3.821333225905007*^9, 3.821333226493701*^9}, {
   3.821333266804682*^9, 3.8213333057726*^9}, {3.821333375983795*^9, 
   3.8213334352131243`*^9}, {3.8213335899638634`*^9, 
   3.8213336476861987`*^9}, {3.8213337999444838`*^9, 3.821333813520009*^9}, {
   3.821333846214574*^9, 3.8213339522463737`*^9}, {3.8213340525749245`*^9, 
   3.821334100875042*^9}, {3.8213342267071095`*^9, 3.82133432187681*^9}, {
   3.8213343918945284`*^9, 3.8213344298560667`*^9}, {3.821334469795992*^9, 
   3.82133454517605*^9}, {3.8213345912969666`*^9, 3.821334593946393*^9}, {
   3.8213349854400473`*^9, 3.821335023258622*^9}, {3.8213350618998117`*^9, 
   3.8213351274603405`*^9}, {3.821335402137231*^9, 3.821335405325981*^9}, {
   3.8213354416902122`*^9, 3.8213354639847946`*^9}, {3.821335504977523*^9, 
   3.8213355543392687`*^9}, {3.821335585265716*^9, 3.82133558571612*^9}, {
   3.8214057879029665`*^9, 3.821405797843964*^9}, {3.8214058976413803`*^9, 
   3.8214059085370097`*^9}, {3.821406063353932*^9, 3.8214061009452753`*^9}, {
   3.821406132884844*^9, 3.821406140289044*^9}, {3.8214061713760433`*^9, 
   3.821406234626092*^9}, {3.821406304654316*^9, 3.8214063645043683`*^9}, {
   3.8214064316208644`*^9, 3.821406487325899*^9}, {3.8214066354487457`*^9, 
   3.8214066712007513`*^9}, {3.821406711092708*^9, 3.821406744419857*^9}, {
   3.82140678779887*^9, 3.8214067891058564`*^9}, {3.821406934155387*^9, 
   3.8214069375423994`*^9}, {3.8214069824559193`*^9, 
   3.8214071036084747`*^9}, {3.821407144781519*^9, 3.8214071774405227`*^9}, 
   3.8214072810774956`*^9, {3.8214073469174967`*^9, 3.8214074288175364`*^9}, {
   3.8214074907338037`*^9, 3.82140756003356*^9}, {3.82140768202671*^9, 
   3.8214076897443714`*^9}, {3.821407791855855*^9, 3.821407792303849*^9}, {
   3.8214078425657587`*^9, 3.821407842704108*^9}, {3.82140787405383*^9, 
   3.821407883183835*^9}, {3.8214079190745792`*^9, 3.8214079208547754`*^9}, {
   3.8214079552555866`*^9, 3.821407984896265*^9}, {3.8214080153459144`*^9, 
   3.821408016249216*^9}, {3.8214082447340393`*^9, 3.8214082449226084`*^9}, {
   3.821408306103978*^9, 3.8214083323618946`*^9}, {3.8214083715823245`*^9, 
   3.8214084087663403`*^9}, {3.82140873714895*^9, 3.8214087412076483`*^9}, {
   3.8214087902672944`*^9, 3.821408810897331*^9}, {3.8214088916823664`*^9, 
   3.8214089320321646`*^9}, {3.8214089638986497`*^9, 
   3.8214090004318914`*^9}, {3.8214091985469775`*^9, 3.82140919895477*^9}, {
   3.8214092860466433`*^9, 3.8214092929982696`*^9}, {3.821409339722107*^9, 
   3.8214093399694357`*^9}, {3.8214093757292147`*^9, 
   3.8214093760177174`*^9}, {3.8214094198004613`*^9, 3.821409452318034*^9}, {
   3.8214095679342356`*^9, 3.8214095862315044`*^9}, {3.821410464953601*^9, 
   3.8214104713011103`*^9}, {3.8214105819119997`*^9, 3.821410613423249*^9}, {
   3.8214107937827415`*^9, 3.8214108118113503`*^9}, {3.8214109130474963`*^9, 
   3.821410956517625*^9}, {3.821411027819234*^9, 3.8214110364382944`*^9}, {
   3.8214112087613783`*^9, 3.8214112093504887`*^9}, {3.8214113066276894`*^9, 
   3.8214113069165306`*^9}, 3.8214113674505315`*^9, {3.8214114580719013`*^9, 
   3.8214114916659746`*^9}, {3.8214115354949307`*^9, 
   3.8214115356159215`*^9}, {3.8214115730106344`*^9, 3.821411573720932*^9}, {
   3.8214116809743357`*^9, 3.8214117432238083`*^9}, {3.8214119450599055`*^9, 
   3.821411954292734*^9}, {3.8214120444740763`*^9, 3.82141204473303*^9}, {
   3.821412087667304*^9, 3.8214121203332295`*^9}, {3.821412152062937*^9, 
   3.8214121628247027`*^9}, {3.8214122422143946`*^9, 
   3.8214122445010223`*^9}, {3.821412277243596*^9, 3.821412277966981*^9}, {
   3.8214124096008434`*^9, 3.821412420899991*^9}, {3.821412464284355*^9, 
   3.821412523208402*^9}, {3.821412587169359*^9, 3.8214125892480555`*^9}, {
   3.821412776832724*^9, 3.821412779571334*^9}, {3.8214128557361803`*^9, 
   3.821412859149687*^9}, {3.8214141614982395`*^9, 3.8214141650759068`*^9}, {
   3.821414219543485*^9, 3.8214142684816475`*^9}, {3.821414318505165*^9, 
   3.8214143250004115`*^9}, {3.8214150191174445`*^9, 3.821415025007677*^9}, {
   3.821415059914157*^9, 3.8214150626623898`*^9}, {3.8214153207277327`*^9, 
   3.8214153515704575`*^9}, {3.821415943957388*^9, 3.821415944974866*^9}, 
   3.821416253202815*^9, {3.821416519319189*^9, 3.8214165220454683`*^9}, {
   3.82141810113037*^9, 3.8214181778116302`*^9}, {3.8214182092059917`*^9, 
   3.821418220143484*^9}, {3.821418336204709*^9, 3.8214183914790363`*^9}, {
   3.8214186524505157`*^9, 3.82141865734048*^9}, {3.8214187480111175`*^9, 
   3.8214188122595167`*^9}, {3.8214189351941433`*^9, 3.8214189375651236`*^9}, 
   3.82141899525272*^9, {3.8214190455305753`*^9, 3.8214190898266964`*^9}, {
   3.8214191735349402`*^9, 3.8214191749125304`*^9}, {3.821419335005584*^9, 
   3.8214193820404997`*^9}, {3.8214194331505156`*^9, 
   3.8214194418286877`*^9}, {3.821419490890646*^9, 3.8214194989485407`*^9}, {
   3.821419816045025*^9, 3.8214198962115216`*^9}, {3.8214203702798233`*^9, 
   3.8214204314685955`*^9}, {3.821420633217374*^9, 3.8214206698676643`*^9}, {
   3.821420699950136*^9, 3.821420787484747*^9}, {3.821421531611025*^9, 
   3.8214215381939955`*^9}, {3.821504423109118*^9, 3.8215044843422246`*^9}, {
   3.8215045245719967`*^9, 3.821504527271971*^9}, {3.821504588523718*^9, 
   3.8215045891881065`*^9}, {3.821504714432623*^9, 3.821504738580758*^9}, {
   3.821504934588786*^9, 3.821504957615198*^9}, {3.821505033795124*^9, 
   3.8215050413381205`*^9}, {3.821505143686029*^9, 3.8215051493979535`*^9}, {
   3.821505229593107*^9, 3.8215052408577137`*^9}, {3.821505365423129*^9, 
   3.8215053917868347`*^9}, {3.821505474481444*^9, 3.8215054789882708`*^9}, {
   3.8215055215915885`*^9, 3.8215055431249094`*^9}, {3.821505588706916*^9, 
   3.8215055925006447`*^9}, {3.821505658564928*^9, 3.821505662111518*^9}, {
   3.8215059088160596`*^9, 3.8215059189718103`*^9}, {3.821506006812296*^9, 
   3.821506021283778*^9}, {3.8215065492385473`*^9, 3.821506551933858*^9}, {
   3.821506745580541*^9, 3.8215067472714014`*^9}, {3.8217590082626963`*^9, 
   3.8217590123060236`*^9}, {3.821762135498758*^9, 3.8217621377629137`*^9}, {
   3.821764402652838*^9, 3.8217644062424026`*^9}, {3.821765167175085*^9, 
   3.8217651915700917`*^9}, 3.822464767648142*^9},
 CellLabel->
  "In[326]:=",ExpressionUUID->"602d43f7-2068-44d0-ac3d-e9540c493a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Calculating", " ", "fidelty", " ", "of", " ", "the", " ", "reconstructed",
     " ", "state"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fidelity", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConjugateTranspose", "[", "a", "]"}], ".", "b"}], ")"}], "*", 
     RowBox[{"Conjugate", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", "a", "]"}], ".", "b"}], ")"}], 
      "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"fidelity", "[", 
      RowBox[{"bobRemaining", ",", "aliceKet"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8208119855700216`*^9, 3.820811997378428*^9}, {
  3.820812035687978*^9, 3.8208121837687845`*^9}, {3.8213309170690527`*^9, 
  3.821330919757005*^9}, {3.821331325950503*^9, 3.8213313966484947`*^9}, {
  3.8214065888317204`*^9, 3.8214065924277053`*^9}, {3.821406750068854*^9, 
  3.821406753546813*^9}, {3.821414259959609*^9, 3.821414262305137*^9}, {
  3.821415044873168*^9, 3.8214150474284363`*^9}},
 CellLabel->
  "In[328]:=",ExpressionUUID->"916d6ec5-c68e-46a9-afae-fb3e2d105506"]
},
WindowSize->{1094, 687},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 9555, 215, 333, "Input",ExpressionUUID->"a5071188-9e4c-40ea-ab6d-b5ca7fd81fd4"],
Cell[10116, 237, 3214, 69, 143, "Input",ExpressionUUID->"1f95a0d4-ebdc-46de-ab20-11831e17cbe4"],
Cell[13333, 308, 8057, 173, 372, "Input",ExpressionUUID->"3efc7279-b01f-4419-b1d6-56c24dcf0a44"],
Cell[21393, 483, 11122, 209, 276, "Input",ExpressionUUID->"602d43f7-2068-44d0-ac3d-e9540c493a2c"],
Cell[32518, 694, 1313, 32, 67, "Input",ExpressionUUID->"916d6ec5-c68e-46a9-afae-fb3e2d105506"]
}
]
*)

